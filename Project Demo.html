<!-- <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" /> -->
<!-- <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script> -->

<!DOCTYPE html>
<html>
	<head>
		<title>Campus Navigation Map</title>
		<meta charset="utf-8" />
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css"
		integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ=="
		crossorigin=""/>

		<!-- Make sure you put this AFTER Leaflet's CSS -->
		<script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js"
		integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ=="
		crossorigin=""></script>
		<style>
			html, body {
				height: 100%;
				margin: 0;
			}
			.leaflet-container {
				height: 500px;
				width: 100%;
				max-width: 100%;
				max-height: 100%;
			}
		</style>
	</head>
	<body>
		<div id="map"></div>
        <script>
            var map = L.map('map').setView([-25.754544, 28.231482], 16);
            
            var tiles = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    maxZoom: 19,
                    attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
            }).addTo(map);

            var popup = L.popup()
                .setLatLng([-25.754544, 28.231482])
                .setContent("University of Pretoria.")
                .openOn(map);

            var mylayer = L.tileLayer.wms("http://mygeoserver.co.za:8080/geoserver/workspace/wms", {
                    layers: 'workspace:mylayer',
                    format: 'image/png',
                    transparent: true,
                    attribution: "GMT 320 Project"
            }).addTo(map);

            // Specify your root URL
            var owsrootUrl = 'http://mygeoserver.co.za:8080/geoserver/workspace/ows';

            // Define your paramenters
            var defaultParameters = {
                            service : 'WFS',
                    version : '1.0.0',
                    request : 'GetFeature',
                    typeName : 'workspace:mylayer',
                    outputFormat : 'text/javascript',
                    format_options : 'callback:getJson',
                    SrsName : 'EPSG:4326'
            };

            /* Combine all of this into a correctly formatted URL
            Refer to this page of the Docs, https://leafletjs.com/reference.html#util */
            var parameters = L.Util.extend(defaultParameters);
            var URL = owsrootUrl + L.Util.getParamString(parameters);

            // create an empty layer
            var WFSLayer = null;

            // this is the ajax request, we are using the jsonp option
            var ajax = $.ajax({
                    url : URL,
                    dataType : 'jsonp',
                    /* this is the callback function that needs to run once the data is received,
                    we are basically telling it to treat the data as a JSON */
                    jsonpCallback : 'getJson',
                    /* if everything works fine, we do the success function, you can also 
                    add a error clause to execute if there was a problem */
                    success : function (response) {
                        //. this is the general Leaflet L.geoJson function, https://leafletjs.com/reference.html#geojson
                        WFSLayer = L.geoJson(response, {
                                style: function (feature) {
                                        return {
                                                //add you styling here
                                        };
                                },
                        }).addTo(map);
                    }
            });

            // Create a search control and add it to the map
            var searchControl = L.Control.geocoder({
            defaultMarkGeocode: false
            }).addTo(map);

            // Add a listener to handle the geocode event
            searchControl.on("markgeocode", function (event) {
            map.setView(event.geocode.center, 16);
            });

        </script>
	</body>
</html>
